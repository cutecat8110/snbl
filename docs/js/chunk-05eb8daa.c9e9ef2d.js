(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-05eb8daa"],{"0ad1":function(e,t,o){"use strict";o("a0fa")},"0d3c":function(e,t,o){"use strict";o("9aba")},"536c":function(e,t,o){"use strict";o("e852")},"590b":function(e,t,o){"use strict";var a=o("7a23");const c=e=>(Object(a["pushScopeId"])("data-v-6b5d3c3c"),e=e(),Object(a["popScopeId"])(),e),l={id:"delProductModal",ref:"modal",class:"modal fade","aria-hidden":"true","aria-labelledby":"delProductModalLabel","data-bs-backdrop":"static",tabindex:"-1"},n={class:"modal-dialog"},s={class:"modal-content border-0"},d={class:"modal-header"},i={id:"delProductModalLabel",class:"modal-title"},r=c(()=>Object(a["createElementVNode"])("button",{class:"btn-close",type:"button","aria-label":"Close","data-bs-dismiss":"modal"},null,-1)),p={class:"modal-body"},b={class:"text-danger"},m={class:"modal-footer"},u=c(()=>Object(a["createElementVNode"])("button",{class:"btn btn-outline-secondary me-3",type:"button","data-bs-dismiss":"modal"}," 取消 ",-1));function O(e,t,o,c,O,j){return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",l,[Object(a["createElementVNode"])("div",n,[Object(a["createElementVNode"])("div",s,[Object(a["createElementVNode"])("div",d,[Object(a["createElementVNode"])("h3",i,[Object(a["createElementVNode"])("span",null,"刪除"+Object(a["toDisplayString"])(o.origin),1)]),r]),Object(a["createElementVNode"])("div",p,[Object(a["createTextVNode"])(" 是否永久刪除【 "),Object(a["createElementVNode"])("strong",b," "+Object(a["toDisplayString"])(o.delItem)+" ",1),Object(a["createTextVNode"])(" 】? ")]),Object(a["createElementVNode"])("div",m,[u,Object(a["createElementVNode"])("button",{class:"btn btn-danger",type:"button",onClick:t[0]||(t[0]=t=>e.$emit("del-item"))},"刪除")])])])],512)}var j=o("e0ae"),h={mixins:[j["a"]],props:["origin","delItem"],emits:["del-item"]};o("0ad1");h.render=O,h.__scopeId="data-v-6b5d3c3c";t["a"]=h},"76be":function(e,t,o){},"9aba":function(e,t,o){},"9f99":function(e,t,o){"use strict";o("76be")},a0fa:function(e,t,o){},d4a2:function(e,t,o){"use strict";var a=o("7a23");const c=e=>(Object(a["pushScopeId"])("data-v-75ca2a47"),e=e(),Object(a["popScopeId"])(),e),l={"aria-label":"Page navigation example"},n={class:"pagination justify-content-end"},s=c(()=>Object(a["createElementVNode"])("span",{"aria-hidden":"true"},"«",-1)),d=c(()=>Object(a["createElementVNode"])("span",{class:"sr-only"},null,-1)),i=[s,d],r={key:0,class:"page-link"},p=["onClick"],b=c(()=>Object(a["createElementVNode"])("span",{"aria-hidden":"true"},"»",-1)),m=c(()=>Object(a["createElementVNode"])("span",{class:"sr-only"},null,-1)),u=[b,m];function O(e,t,o,c,s,d){return Object(a["openBlock"])(),Object(a["createElementBlock"])("nav",l,[Object(a["createElementVNode"])("ul",n,[Object(a["createElementVNode"])("li",{class:Object(a["normalizeClass"])([{disabled:1===o.pages.current_page},"page-item"])},[Object(a["createElementVNode"])("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=Object(a["withModifiers"])(e=>d.emitPage(o.pages.current_page-1),["prevent"]))},i)],2),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(o.pages.total_pages,(e,t)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("li",{key:t,class:Object(a["normalizeClass"])([{active:e===o.pages.current_page},"page-item"])},[e===o.pages.current_page?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",r,Object(a["toDisplayString"])(e),1)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("a",{key:1,class:"page-link",href:"#",onClick:Object(a["withModifiers"])(t=>d.emitPage(e),["prevent"])},Object(a["toDisplayString"])(e),9,p))],2))),128)),Object(a["createElementVNode"])("li",{class:Object(a["normalizeClass"])([{disabled:o.pages.current_page===o.pages.total_pages},"page-item"])},[Object(a["createElementVNode"])("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=Object(a["withModifiers"])(e=>d.emitPage(o.pages.current_page+1),["prevent"]))},u)],2)])])}var j={props:["pages"],methods:{emitPage(e){this.$emit("emit-page",e)}}};o("0d3c");j.render=O,j.__scopeId="data-v-75ca2a47";t["a"]=j},e532:function(e,t,o){"use strict";o.r(t);var a=o("7a23");const c=e=>(Object(a["pushScopeId"])("data-v-9cbd5b54"),e=e(),Object(a["popScopeId"])(),e),l={class:"container py-4"},n={class:"bg-white px-4 border"},s={class:"navbar py-3"},d={class:"container-fluid"},i=c(()=>Object(a["createElementVNode"])("span",{class:"navbar-brand"},"優惠管理列表",-1)),r=c(()=>Object(a["createElementVNode"])("i",{class:"material-icons md-18"},"add",-1)),p=c(()=>Object(a["createElementVNode"])("span",null,"新增",-1)),b=[r,p],m={class:"table-responsive mb-3"},u={class:"table table-hover align-middle mb-0"},O=c(()=>Object(a["createElementVNode"])("thead",{class:"bg-gray-000"},[Object(a["createElementVNode"])("tr",null,[Object(a["createElementVNode"])("th",{class:"position-relative",width:"128"},"有效期限"),Object(a["createElementVNode"])("th",{class:"position-relative"},"名稱"),Object(a["createElementVNode"])("th",{class:"position-relative"},"優惠碼"),Object(a["createElementVNode"])("th",{class:"position-relative"},"折扣"),Object(a["createElementVNode"])("th",{class:"position-relative",width:"128"},"狀態"),Object(a["createElementVNode"])("th",{width:"128"},"編輯")])],-1)),j={key:0,class:"text-success d-flex align-items-center"},h=c(()=>Object(a["createElementVNode"])("div",{class:"circle bg-success me-2"},null,-1)),g=c(()=>Object(a["createElementVNode"])("span",null,"啟用 ",-1)),E=[h,g],N={key:1,class:"d-flex align-items-center"},V=c(()=>Object(a["createElementVNode"])("div",{class:"circle bg-gray-300 me-2"},null,-1)),v=c(()=>Object(a["createElementVNode"])("span",null,"關閉 ",-1)),C=[V,v],k={class:"btn-group"},f=["onClick"],y=["onClick"];function _(e,t,o,c,r,p){const h=Object(a["resolveComponent"])("Loading"),g=Object(a["resolveComponent"])("Pagination"),V=Object(a["resolveComponent"])("CouponModal"),v=Object(a["resolveComponent"])("DelModal");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",null,[Object(a["createVNode"])(h,{active:r.isLoading,"z-index":1060},null,8,["active"]),Object(a["createElementVNode"])("div",l,[Object(a["createElementVNode"])("div",n,[Object(a["createElementVNode"])("div",s,[Object(a["createElementVNode"])("div",d,[i,Object(a["createElementVNode"])("button",{class:"btn-sm btn-primary d-flex align-items-center",onClick:t[0]||(t[0]=e=>p.openCouponModal(!0))},b)])]),Object(a["createElementVNode"])("div",m,[Object(a["createElementVNode"])("table",u,[O,Object(a["createElementVNode"])("tbody",null,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(r.coupons,(t,o)=>(Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",{key:o},[Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(e.$filters.date(t.due_date)),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.title),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.code),1),Object(a["createElementVNode"])("td",null,Object(a["toDisplayString"])(t.percent/10)+" 折",1),Object(a["createElementVNode"])("td",null,[1===t.is_enabled?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",j,E)):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",N,C))]),Object(a["createElementVNode"])("td",null,[Object(a["createElementVNode"])("div",k,[Object(a["createElementVNode"])("button",{class:"btn btn-outline-primary btn-sm",onClick:e=>p.openCouponModal(!1,t)}," 編輯 ",8,f),Object(a["createElementVNode"])("button",{class:"btn btn-outline-danger btn-sm",onClick:e=>p.openDelCouponModal(t)}," 刪除 ",8,y)])])]))),128))])])]),Object(a["createVNode"])(g,{pages:r.pagination,onEmitPage:p.getCoupons},null,8,["pages","onEmitPage"])])]),Object(a["createVNode"])(V,{ref:"couponModal",coupon:r.tempCoupon,"is-new":r.isNew,onUpdateCoupon:p.updateCoupon},null,8,["coupon","is-new","onUpdateCoupon"]),Object(a["createVNode"])(v,{ref:"delModal",delItem:r.tempCoupon.title,origin:r.pageName,onDelItem:p.delCoupon},null,8,["delItem","origin","onDelItem"])])}const M=e=>(Object(a["pushScopeId"])("data-v-dae3ab30"),e=e(),Object(a["popScopeId"])(),e),w={id:"couponModal",ref:"modal",class:"modal fade","aria-hidden":"true","aria-labelledby":"couponModalLabel","data-bs-backdrop":"static",tabindex:"-1"},B={class:"modal-dialog modal-dialog-scrollable"},x={class:"modal-content border-0"},S={class:"modal-header"},D={id:"exampleModalLabel",class:"modal-title"},I={key:0},P={key:1},L=M(()=>Object(a["createElementVNode"])("button",{class:"btn-close",type:"button","aria-label":"Close","data-bs-dismiss":"modal"},null,-1)),$={class:"modal-body"},T={class:"row g-3 mb-3"},U={class:"col-12"},z=M(()=>Object(a["createElementVNode"])("label",{class:"form-label",for:"title"},"優惠名稱",-1)),F={class:"col-12"},J=M(()=>Object(a["createElementVNode"])("label",{class:"form-label",for:"coupon_code"},"優惠碼",-1)),R={class:"col-12"},q=M(()=>Object(a["createElementVNode"])("label",{class:"form-label",for:"due_date"},"有效期限",-1)),A={class:"col-12"},G=M(()=>Object(a["createElementVNode"])("label",{class:"form-label",for:"price"},"折扣",-1)),H={class:"input-group"},K=M(()=>Object(a["createElementVNode"])("span",{class:"input-group-text bg-light"},"折",-1)),Q={class:"col-12"},W=M(()=>Object(a["createElementVNode"])("label",null," 優惠方案 ",-1)),X={class:"col"},Y={class:"d-inline-block py-2 me-2",for:"isEnabled1"},Z=M(()=>Object(a["createElementVNode"])("span",{class:"px-2"}," 啟用 ",-1)),ee={class:"d-inline-block py-2 me-2",for:"isEnabled0"},te=M(()=>Object(a["createElementVNode"])("span",{class:"px-2"}," 關閉 ",-1)),oe={class:"modal-footer"},ae=M(()=>Object(a["createElementVNode"])("button",{class:"btn btn-outline-secondary me-3",type:"button","data-bs-dismiss":"modal"}," 取消 ",-1));function ce(e,t,o,c,l,n){return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",w,[Object(a["createElementVNode"])("div",B,[Object(a["createElementVNode"])("div",x,[Object(a["createElementVNode"])("div",S,[Object(a["createElementVNode"])("h3",D,[o.isNew?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",I,"新增優惠")):(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",P,"編輯優惠"))]),L]),Object(a["createElementVNode"])("div",$,[Object(a["createElementVNode"])("div",T,[Object(a["createElementVNode"])("div",U,[z,Object(a["createElementVNode"])("div",{class:Object(a["normalizeClass"])([l.tempCoupon.title?"inputClear":"","form-group position-relative"])},[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>l.tempCoupon.title=e),class:"form-control",type:"text",placeholder:"請輸入"},null,512),[[a["vModelText"],l.tempCoupon.title]]),l.tempCoupon.title?(Object(a["openBlock"])(),Object(a["createElementBlock"])("button",{key:0,onClick:t[1]||(t[1]=()=>{l.tempCoupon.title="",e.clearFocus("productTitle")}),class:"btn-close position-absolute top-50 end-0 translate-middle-y",type:"button"})):Object(a["createCommentVNode"])("",!0)],2)]),Object(a["createElementVNode"])("div",F,[J,Object(a["createElementVNode"])("div",{class:Object(a["normalizeClass"])([l.tempCoupon.code?"inputClear":"","form-group position-relative"])},[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{id:"coupon_code","onUpdate:modelValue":t[2]||(t[2]=e=>l.tempCoupon.code=e),class:"form-control",type:"text",placeholder:"請輸入"},null,512),[[a["vModelText"],l.tempCoupon.code]]),l.tempCoupon.code?(Object(a["openBlock"])(),Object(a["createElementBlock"])("button",{key:0,onClick:t[3]||(t[3]=()=>{l.tempCoupon.code="",e.clearFocus("productTitle")}),class:"btn-close position-absolute top-50 end-0 translate-middle-y",type:"button"})):Object(a["createCommentVNode"])("",!0)],2)]),Object(a["createElementVNode"])("div",R,[q,Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{id:"due_date","onUpdate:modelValue":t[4]||(t[4]=e=>l.due_date=e),class:"form-control",type:"date"},null,512),[[a["vModelText"],l.due_date]])]),Object(a["createElementVNode"])("div",A,[G,Object(a["createElementVNode"])("div",H,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{id:"price","onUpdate:modelValue":t[5]||(t[5]=e=>l.tempCoupon.percent=e),class:"form-control",type:"number",placeholder:"請輸入例如：85 ( 等於 8.5 折 )",max:"100",min:"0"},null,512),[[a["vModelText"],l.tempCoupon.percent,void 0,{number:!0}]]),K])]),Object(a["createElementVNode"])("div",Q,[W,Object(a["createElementVNode"])("div",X,[Object(a["createElementVNode"])("label",Y,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{id:"isEnabled1","onUpdate:modelValue":t[6]||(t[6]=e=>l.tempCoupon.is_enabled=e),class:"form-check-input",type:"radio",value:"1"},null,512),[[a["vModelRadio"],l.tempCoupon.is_enabled]]),Z]),Object(a["createElementVNode"])("label",ee,[Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{id:"isEnabled0","onUpdate:modelValue":t[7]||(t[7]=e=>l.tempCoupon.is_enabled=e),class:"form-check-input",type:"radio",value:"0"},null,512),[[a["vModelRadio"],l.tempCoupon.is_enabled]]),te])])])])]),Object(a["createElementVNode"])("div",oe,[ae,Object(a["createElementVNode"])("button",{class:"btn btn-primary",type:"button",onClick:t[8]||(t[8]=t=>e.$emit("update-coupon",l.tempCoupon))}," 確定 ")])])])],512)}var le=o("e0ae"),ne={mixins:[le["a"]],props:{coupon:{type:Object,default(){return{}}},isNew:{type:Boolean,default:!1}},emits:["update-coupon"],data(){return{tempCoupon:{},due_date:""}},watch:{coupon(){this.tempCoupon=JSON.parse(JSON.stringify(this.coupon));const e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");[this.due_date]=e,void 0===this.tempCoupon.is_enabled&&(this.tempCoupon.is_enabled=1)},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}}};o("536c");ne.render=ce,ne.__scopeId="data-v-dae3ab30";var se=ne,de=o("590b"),ie=o("d4a2"),re={components:{CouponModal:se,DelModal:de["a"],Pagination:ie["a"]},inject:["httpMessageState"],data(){return{pageName:"優惠",coupons:{},pagination:[],tempCoupon:{title:"",is_enabled:0,percent:100,code:""},isLoading:!1,isNew:!1,currentPage:1}},methods:{openCouponModal(e,t){this.isNew=e,this.isNew?this.tempCoupon={due_date:(new Date).getTime()/1e3}:this.tempCoupon={...t},this.$refs.couponModal.openModal()},openDelCouponModal(e){this.tempCoupon={...e},this.$refs.delModal.openModal()},getCoupons(e=1){this.isLoading=!0,this.currentPage=e;const t="https://vue3-course-api.hexschool.io/api/haohao/admin/coupons";this.$http.get(t,this.tempProduct).then(e=>{this.pagination=e.data.pagination,this.coupons=e.data.coupons,this.isLoading=!1})},updateCoupon(e){this.isLoading=!0,this.tempCoupon=e,this.tempCoupon.is_enabled=Number(this.tempCoupon.is_enabled);let t="https://vue3-course-api.hexschool.io/api/haohao/admin/coupon",o="post",a="新增優惠";this.isNew||(t="https://vue3-course-api.hexschool.io/api/haohao/admin/coupon/"+this.tempCoupon.id,o="put",a="更新優惠"),this.$http[o](t,{data:this.tempCoupon}).then(e=>{e.data.success?(this.getCoupons(this.currentPage),this.isLoading=!1,this.$refs.couponModal.hideModal(),this.httpMessageState(e,a)):(this.isLoading=!1,this.httpMessageState(e,a))})},delCoupon(){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/api/haohao/admin/coupon/"+this.tempCoupon.id;this.$http.delete(e).then(e=>{this.getCoupons(this.currentPage),this.isLoading=!1,this.httpMessageState(e,"刪除優惠"),this.$refs.delModal.hideModal()})}},created(){this.getCoupons()}};o("9f99");re.render=_,re.__scopeId="data-v-9cbd5b54";t["default"]=re},e852:function(e,t,o){}}]);
//# sourceMappingURL=chunk-05eb8daa.c9e9ef2d.js.map